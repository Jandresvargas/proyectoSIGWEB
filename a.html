<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Filtrar atributos en GeoJSON con Leaflet</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
      #map {
        height: 400px;
      }
      .filter-control {
        background-color: white;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <div id="filter-control" class="filter-control">
      <h3>Filtro de atributos</h3>
      <select id="attribute-filter">
        <option value="NOMBRE">Atributo 1</option>
        <option value="UBICACION">Atributo 2</option>
        <option value="TIPO">Atributo 3</option>
      </select>
    </div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
      var map = L.map('map').setView([51.505, -0.09], 13);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors'
      }).addTo(map);

      // Cargar el archivo GeoJSON
      fetch('sitios_interes.geojson')
        .then(response => response.json())
        .then(data => {
          var geojsonLayer = L.geoJSON(data).addTo(map);

          // Control de filtro de atributos
          var filterControl = L.control({ position: 'topright' });
          filterControl.onAdd = function(map) {
            var controlDiv = L.DomUtil.get('filter-control');
            L.DomEvent.disableClickPropagation(controlDiv);
            return controlDiv;
          }
          filterControl.addTo(map);

          // Aplicar filtro cuando cambie la selecciÃ³n
          var attributeFilter = document.getElementById('attribute-filter');
          attributeFilter.addEventListener('change', function(event) {
            var selectedAttribute = event.target.value;
            geojsonLayer.eachLayer(function(layer) {
              if (layer.feature.properties.attribute === selectedAttribute) {
                layer.setStyle({ fillOpacity: 0.8 });
              } else {
                layer.setStyle({ fillOpacity: 0 });
              }
            });
          });
        })
        .catch(error => {
          console.error('Error al cargar el archivo GeoJSON:', error);
        });
    </script>
  </body>
</html>
